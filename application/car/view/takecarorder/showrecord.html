<style type="text/css">
 #allmap {width:100%;height:100%;}
</style>

<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=6g0xlY8ISU77UsnVp7EgIt3mV54k6Gmz"></script>
<script type="text/javascript" src="http://api.map.baidu.com/library/LuShu/1.2/src/LuShu_min.js"></script>

<div class="layui-form-item" style="display:block;height:400px;">
	<div id="allmap"></div>
</div>

<table class="layui-table" lay-skin="row" lay-even="">
    <tbody>
			<tr>
				<td style="width: 100px;">
					订单编号：{$record.order_num}
				</td>
				<td style="width: 100px;">
					订单类型：{$record.order_type}
				</td>
				<td style="width: 100px;">
					订单状态：{$record.order_status}
				</td>
				<td style="width: 100px;">
					订单开始时间：{$record.start_time}
				</td>
				<td style="width: 150px;">
					订单结束时间：{$record.end_time}
				</td>
				<td style="width: 100px;">
					城市：{$record.city_name}
				</td>
				<td style="width: 100px;">
					楼盘：{$record.build_name}
				</td>
			</tr>

			<tr>
				<td style="width: 100px;">
					司机：{$record.driver_name}
				</td>
				<td style="width: 100px;">
					车牌号：{$record.number_plate}
				</td>
				<td style="width: 100px;">
					部门：{$record.department_name}
				</td>
				<td style="width: 100px;">
					销售顾问：{$record.sale_name}
				</td>
				<td style="width: 150px;">
					起始地：{$record.start_address}
				</td>
				<td style="width: 100px;">
					目的地：{$record.end_address}
				</td>
				<td style="width: 100px;">
					行驶公里数：{$record.driver_start_mileage}
				</td>
			</tr>

    </tbody>		
	
    </tbody>
</table>

<script type="text/javascript">
// 百度地图API功能

        var map = new BMap.Map('allmap');
        map.enableScrollWheelZoom();
        var lushu;
     	var arrPois = new Array();
     	var array = eval('(["110.387866,19.979003","110.387866,19.979003","110.387866,19.979003","110.387866,19.979003","110.387866,19.979003","110.387866,19.979003","110.387866,19.979003","110.387866,19.979003","110.387866,19.979003","110.387866,19.979003","110.387866,19.979003","110.387866,19.979003","110.387866,19.979003","110.387866,19.979003","110.387866,19.979003","110.387866,19.979003","110.387866,19.979003","110.387866,19.979003","110.387878,19.979005","110.387888,19.979006","110.387901,19.979006","110.387918,19.979007","110.387938,19.979011","110.387957,19.979015","110.387971,19.979017","110.387988,19.979018","110.388012,19.979022","110.388038,19.979024","110.388065,19.979031","110.388092,19.979037","110.38812,19.979046","110.388154,19.979051","110.388188,19.979057","110.388227,19.979058","110.388261,19.979063","110.388298,19.979059","110.388343,19.979057","110.388389,19.979057","110.388428,19.979055","110.388466,19.979056","110.3885,19.979058","110.388535,19.979059","110.388575,19.979057","110.388623,19.979054","110.388676,19.979056","110.388736,19.97906","110.388797,19.979062","110.388861,19.979066","110.388919,19.97907","110.388974,19.979074","110.389033,19.979073","110.389097,19.979074","110.38916,19.979076","110.389222,19.97908","110.389287,19.979083","110.389347,19.979085","110.389407,19.979085","110.389461,19.979084","110.389513,19.979086","110.389513,19.979086","110.389565,19.97909","110.389606,19.979096","110.389648,19.979105","110.389687,19.979116","110.38972,19.979124","110.389748,19.979129","110.389773,19.979133","110.389798,19.979138","110.389822,19.979143","110.38984,19.979145","110.389854,19.979146","110.389862,19.979148","110.389867,19.979146","110.389871,19.979148","110.389872,19.979146","110.389874,19.979148","110.389876,19.979148","110.389877,19.979148","110.389881,19.979151","110.389882,19.979153","110.389884,19.979154","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389887,19.979158","110.389919,19.979165","110.389929,19.979169","110.389933,19.979172","110.389938,19.979176","110.389943,19.979181","110.389949,19.979187","110.389958,19.979194","110.389969,19.979204","110.389983,19.979222","110.389988,19.979242","110.389994,19.979261","110.390001,19.979285","110.390004,19.979315","110.390004,19.979355","110.390003,19.979401","110.389999,19.979445","110.389994,19.979485","110.389989,19.979511","110.389989,19.979528","110.389988,19.979536","110.389988,19.979541","110.389988,19.979546","110.389986,19.979551","110.389979,19.979564","110.389973,19.979584","110.389964,19.979617","110.389954,19.979655","110.389948,19.979698","110.389938,19.97975","110.389926,19.97981","110.389916,19.979878","110.389901,19.97995","110.389901,19.97995","110.389882,19.980024","110.389871,19.980092","110.389858,19.980157","110.389846,19.98022","110.389833,19.980279","110.389818,19.980346","110.389806,19.980416","110.389796,19.980482","110.389785,19.980546","110.389773,19.980599","110.389765,19.980648","110.389758,19.980701","110.38975,19.980761","110.389743,19.980826","110.389735,19.980898","110.389735,19.980898","110.389726,19.980969","110.389718,19.981041","110.389706,19.981116","110.389696,19.981191","110.389683,19.981273","110.389666,19.981359","110.38965,19.981453","110.389631,19.981543","110.389613,19.981633","110.389594,19.98172","110.389576,19.981808","110.389576,19.981808","110.389557,19.9819","110.389533,19.981997","110.389502,19.982098","110.38947,19.982196","110.38943,19.982294","110.389392,19.982388","110.389351,19.982478","110.389313,19.982568","110.38927,19.982662","110.38927,19.982662","110.38922,19.982757","110.389166,19.982856","110.389108,19.982954","110.389049,19.983052","110.388997,19.983148","110.388947,19.983241","110.388895,19.983329","110.388847,19.983413","110.388794,19.9835","110.388794,19.9835","110.388737,19.983589","110.388677,19.983681","110.388615,19.983773","110.388563,19.98386","110.38852,19.983937","110.388483,19.984001","110.388453,19.984049","110.388432,19.984087","110.388413,19.98412","110.388398,19.984149","110.388378,19.984184","110.38836,19.984221","110.388343,19.984253","110.38833,19.98428","110.38833,19.98428","110.38832,19.984298","110.388313,19.984332","110.3883,19.984373","110.388283,19.984417","110.388263,19.984469","110.388231,19.984522","110.388199,19.984583","110.388166,19.984644","110.388134,19.9847","110.388108,19.984753","110.388079,19.984799","110.388059,19.984842","110.388046,19.984877","110.388038,19.984912","110.388031,19.984952","110.388028,19.984992","110.388026,19.985035","110.388028,19.98508","110.38804,19.985125","110.388058,19.985173","110.388058,19.985173","110.388086,19.985228","110.388116,19.985294","110.388154,19.985368","110.388217,19.985434","110.388305,19.985491","110.388392,19.985538","110.388476,19.985581","110.388565,19.985629","110.388658,19.985678","110.388757,19.985729","110.388856,19.985778","110.388856,19.985778","110.388954,19.98583","110.389055,19.985878","110.389149,19.985925","110.389249,19.985974","110.389347,19.986024","110.389448,19.986073","110.389551,19.986122","110.389652,19.986171","110.389752,19.986221","110.389752,19.986221","110.389853,19.986269","110.389952,19.986317","110.390051,19.986368","110.390154,19.986417","110.390252,19.986473","110.390359,19.986522","110.390466,19.986574","110.390568,19.986624","110.390671,19.986673","110.390671,19.986673","110.390775,19.986725","110.390874,19.986776","110.390973,19.986827","110.391068,19.986877","110.391163,19.986924","110.391264,19.986971","110.391344,19.987009","110.39142,19.987035","110.391484,19.987064"])');
     	for (var i = 0; i < array.length; i++) {
     		var str = array[i].split(",");
     		arrPois.push(new BMap.Point(str[0],str[1]));
     	}
     	if(array.length == 0){
     		var startLat = {$record.start_lat};
     		var startLng = {$record.start_lng};
     		map.centerAndZoom(new BMap.Point(startLng, startLat), 10);
     	}else{
     		var lastStr = array[array.length-1].split(",");
     		map.centerAndZoom(new BMap.Point(lastStr[0], lastStr[1]), 10);
     	}
     	//map.centerAndZoom(new BMap.Point(lastStr[0], lastStr[1]),10);

      	map.addOverlay(new BMap.Polyline(arrPois, {strokeColor: '#111'}));
      	lushu = new BMapLib.LuShu(map, arrPois, {
                        autoView : true,
                        enableRotation : true,
                        autoView:true,//是否开启自动视野调整，如果开启那么路书在运动过程中会根据视野自动调整
                        icon  : new BMap.Icon('http://developer.baidu.com/map/jsdemo/img/car.png', new BMap.Size(52,26),{anchor : new BMap.Size(27, 13)}),
                        speed : 500,
                        landmarkPois:[]
         });
      	lushu.start();

</script>
